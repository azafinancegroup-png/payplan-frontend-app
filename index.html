<!DOCTYPE html>
<html lang="no">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PayPlan AI: Saksbehandler V3.0 - Låneanalyse</title>
    <!-- Laster inn Tailwind CSS for moderne og responsiv styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Tilpassede stiler basert på brukerens krav og for å overstyre Tailwind der det trengs */
        :root {
            --dark-blue: #003366;
            --light-blue: #00509e;
            --result-bg: #f0f8ff; /* Lightest Blue */
            --risk-red: #e60000;
            --success-green: #28a745;
        }

        /* Bruker 'Inter' som forespurt, selv om Tailwind/Immersive ofte bruker det som standard */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f4f7f6;
        }

        .container {
            max-width: 700px;
        }

        /* Hovedtittel styling - Mørk Blå med linje */
        .header-title {
            color: var(--dark-blue);
            border-bottom: 3px solid var(--dark-blue);
        }

        /* Styling for store tall i resultatfeltet */
        .huge-number {
            font-size: 2.25rem; /* Stort tall */
            font-weight: 700;
            color: var(--dark-blue);
            display: block;
        }
        
        /* Risiko Flagg Styling: Dark Red, litt større, semi-bold (ikke helt bold) */
        .risk-flag {
            color: var(--risk-red); 
            font-weight: 500; /* Medium weight */
            font-size: 1.02rem; /* Normal + 2% bigger */
            margin: 5px 0;
            padding-left: 15px;
            position: relative;
        }
        .risk-flag::before {
            content: "•";
            color: var(--risk-red);
            position: absolute;
            left: 0;
            font-weight: 900;
        }

        /* Bank Match Grid */
        .bank-match-container {
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        }

        /* Loading Spinner */
        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid var(--dark-blue);
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Input styling for bedre utseende */
        .input-group label {
            font-weight: 600;
            color: #374151;
            font-size: 0.875rem;
            display: block;
            margin-bottom: 4px;
        }

        .input-group input[type="text"],
        .input-group input[type="number"],
        .input-group select {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid #d1d5db;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.2s, box-shadow 0.2s;
        }

        .input-group input:focus,
        .input-group select:focus {
            border-color: var(--light-blue);
            box-shadow: 0 0 0 2px rgba(0, 80, 158, 0.2);
            outline: none;
        }

    </style>
    <script>
        // --- Globale konstanter og verktøyfunksjoner ---
        
        // Reguleringer fra Utlånsforskriften (Simulerte verdier for analyse)
        const MAX_GJELDSGRAD = 5.0; // Maksimal gjeldsgrad
        const MAX_LTV = 0.85;       // Maksimal LTV (85%)
        const RENTETEST_BUFFER = 0.05; // 5% renteøkning buffer

        // OPPDATERT: Utvidet Bankliste med simulerte kriterier for Matching
        const BANK_PROFILES = [
            // Ordinære banker (foretrekkes for sterke profiler, strenge krav)
            { navn: "DNB Bank", type: "Ordinær", score_min: 85, inkasso: false, gjeldsgrad_max: 5.0, ltv_max: 0.85, sjanse_faktor: 1.00 },
            { navn: "Nordea", type: "Ordinær", score_min: 80, inkasso: false, gjeldsgrad_max: 4.8, ltv_max: 0.85, sjanse_faktor: 0.95 },
            { navn: "Danske Bank", type: "Ordinær", score_min: 75, inkasso: false, gjeldsgrad_max: 4.9, ltv_max: 0.80, sjanse_faktor: 0.90 },
            { navn: "Handelsbanken", type: "Ordinær", score_min: 70, inkasso: false, gjeldsgrad_max: 5.0, ltv_max: 0.85, sjanse_faktor: 0.88 },
            { navn: "Sbanken", type: "Ordinær", score_min: 80, inkasso: false, gjeldsgrad_max: 4.7, ltv_max: 0.85, sjanse_faktor: 0.92 },
            { navn: "SpareBank 1 (Østlandet)", type: "Ordinær (Regional)", score_min: 70, inkasso: false, gjeldsgrad_max: 5.0, ltv_max: 0.85, sjanse_faktor: 0.85 },
            { navn: "Sparebanken Vest", type: "Ordinær (Regional)", score_min: 70, inkasso: false, gjeldsgrad_max: 5.0, ltv_max: 0.85, sjanse_faktor: 0.85 },
            { navn: "BN Bank", type: "Ordinær", score_min: 75, inkasso: false, gjeldsgrad_max: 4.8, ltv_max: 0.85, sjanse_faktor: 0.90 },
            { navn: "KLP Banken", type: "Ordinær (Medlem)", score_min: 80, inkasso: false, gjeldsgrad_max: 5.0, ltv_max: 0.85, sjanse_faktor: 0.95 },
            
            // Spesialbanker/Forbruksbanker (mer fleksible/høyere risiko/andre formål)
            { navn: "Santander Consumer Bank", type: "Spesial/Forbruk", score_min: 60, inkasso: false, gjeldsgrad_max: 5.5, ltv_max: 0.90, sjanse_faktor: 0.75 },
            { navn: "Bank Norwegian", type: "Spesial/Forbruk", score_min: 65, inkasso: false, gjeldsgrad_max: 5.5, ltv_max: 0.90, sjanse_faktor: 0.70 },
            { navn: "Komplett Bank", type: "Spesial/Forbruk", score_min: 55, inkasso: false, gjeldsgrad_max: 6.0, ltv_max: 0.95, sjanse_faktor: 0.65 },
            { navn: "Nordax Bank", type: "Spesial/Refinans", score_min: 40, inkasso: false, gjeldsgrad_max: 7.0, ltv_max: 1.00, sjanse_faktor: 0.80 },
            { navn: "Bank2", type: "Spesial/Refinans", score_min: 50, inkasso: false, gjeldsgrad_max: 5.5, ltv_max: 0.90, sjanse_faktor: 0.78 },
            { navn: "Kraft Bank", type: "Spesial/Inkasso", score_min: 30, inkasso: true, gjeldsgrad_max: 8.0, ltv_max: 1.00, sjanse_faktor: 0.90 },
        ];


        /**
         * Formatterer et tall med tusenskillere (mellomrom).
         * @param {number} num - Tallet som skal formateres.
         * @returns {string} - Formatert streng.
         */
        const formatterTall = (num) => {
            if (num === null || num === undefined || isNaN(num)) return "N/A";
            // Bruker norsk locale for tusenskillere (mellomrom)
            return num.toFixed(0).replace(/\B(?=(\d{3})+(?!\d))/g, " ");
        };

        /**
         * Henter og validerer inndata.
         * @param {string} id - ID på input-elementet.
         * @param {boolean} isNumeric - Hvorvidt verdien skal konverteres til tall.
         * @returns {number|string|null} - Parsert verdi eller null.
         */
        const hentVerdi = (id, isNumeric = true) => {
            const element = document.getElementById(id);
            if (!element) return null;

            let value = element.value.trim();

            if (isNumeric) {
                // Fjerner tusenskillere (mellomrom) og erstatter komma med punktum
                value = value.replace(/ /g, '').replace(/,/g, '.');
                const num = parseFloat(value);
                return isNaN(num) ? 0 : num;
            }
            
            return value;
        };

        /**
         * Hovedfunksjon for å kjøre analysen
         */
        const kjørAnalyse = async () => {
            const resultatBoks = document.getElementById('results-box');
            const resultatInnhold = document.getElementById('analysis-content');
            const submitBtn = document.getElementById('submit-btn');

            // Vis laste-spinner og deaktiver knapp
            resultatInnhold.innerHTML = `<div class="spinner-container flex justify-center items-center h-20">
                                            <div class="spinner"></div>
                                            <p class="ml-4 text-gray-600">Kjører dyp analyse...</p>
                                        </div>`;
            resultatBoks.classList.remove('hidden');
            submitBtn.disabled = true;

            // Simuler forsinkelse for "dyp analyse"
            await new Promise(resolve => setTimeout(resolve, 1500));

            // --- 1. Hent og Samle Data (Hovedsøker + Medsøker) ---

            // Hovedsøker
            const inntekt_soker = hentVerdi('inntekt_soker');
            const kredittkort_ramme_soker = hentVerdi('kredittkort_ramme_soker');
            const forbrukslan_soker = hentVerdi('forbrukslan_soker');
            const billan_soker = hentVerdi('billan_soker');
            const studielan_soker = hentVerdi('studielan_soker');
            const arbeidsforhold_soker = hentVerdi('arbeidsforhold_soker', false);
            const har_inkasso_soker = hentVerdi('har_inkasso_soker', false) === 'Ja';

            // Medsøker (Henter kun hvis checkbox er huket av)
            let total_inntekt = inntekt_soker;
            let total_gjeld = (kredittkort_ramme_soker * 0.4) // Kredittkortramme multipliseres med 40% (Utlånsforskriften)
                            + forbrukslan_soker
                            + billan_soker
                            + studielan_soker;

            const har_medsoker = document.getElementById('medsoker_checkbox').checked;
            let har_inkasso_medsoker = false;

            if (har_medsoker) {
                const inntekt_medsoker = hentVerdi('inntekt_medsoker');
                const kredittkort_ramme_medsoker = hentVerdi('kredittkort_ramme_medsoker');
                const forbrukslan_medsoker = hentVerdi('forbrukslan_medsoker');
                const billan_medsoker = hentVerdi('billan_medsoker');
                const studielan_medsoker = hentVerdi('studielan_medsoker');
                har_inkasso_medsoker = hentVerdi('har_inkasso_medsoker', false) === 'Ja';

                total_inntekt += inntekt_medsoker;
                total_gjeld += (kredittkort_ramme_medsoker * 0.4)
                                + forbrukslan_medsoker
                                + billan_medsoker
                                + studielan_medsoker;
            }

            // Felles data
            const onsket_lan = hentVerdi('onsket_lan');
            const boligverdi = hentVerdi('boligverdi');
            const egenkapital = hentVerdi('egenkapital');
            const antall_barn_under_18 = hentVerdi('antall_barn_under_18');
            const inkasso_bank_historikk = hentVerdi('inkasso_bank_historikk', false);
            const egenkapital_kilde = hentVerdi('egenkapital_kilde', false);

            const har_inkasso_totalt = har_inkasso_soker || har_inkasso_medsoker;
            const lan_med_gjeld = onsket_lan + total_gjeld; // Total lån/gjeld ekskl. boliglån

            // --- 2. Hovedberegninger (Utlånsforskriften) ---

            const total_lan_pluss_gjeld = lan_med_gjeld;
            
            // Gjeldsgrad (Debt-to-Income)
            const gjeldsgrad = total_inntekt > 0 ? (total_lan_pluss_gjeld / total_inntekt) : Infinity;

            // LTV (Loan-to-Value)
            const ltv = boligverdi > 0 ? (onsket_lan / boligverdi) : Infinity;
            
            // Rentetest (Simulerer 5% renteøkning på total lån/gjeld)
            const rentetest_gjeld = total_lan_pluss_gjeld;
            const rentetest_okt_belastning = rentetest_gjeld * RENTETEST_BUFFER; 
            const inntekt_mot_belastning = total_inntekt * 0.2; // Forenklet betjeningsevne sjekk (20% av inntekt)

            // --- 3. Generer Risiko Flagg og Løsningsforslag ---
            let flags = [];
            let suggestions = [];
            let initial_score = 100;

            // Flagg: Gjeldsgrad
            if (gjeldsgrad > MAX_GJELDSGRAD) {
                flags.push(`For høy gjeldsgrad (${gjeldsgrad.toFixed(2)}x) – over ${MAX_GJELDSGRAD.toFixed(1)}x inntekt (Utlånsforskriften).`);
                
                const mål_gjeld = total_inntekt * MAX_GJELDSGRAD;
                const reduksjon_nødvendig = total_lan_pluss_gjeld - mål_gjeld;

                suggestions.push(`[Gjeldsgrad] Reduser total lån/gjeld med ${formatterTall(reduksjon_nødvendig)} kr for å møte lovkravet. (Mål: ${formatterTall(mål_gjeld)} kr total gjeld)`);
                initial_score -= 30; 
            } else if (gjeldsgrad > 4.5) {
                 flags.push(`Høy gjeldsgrad (${gjeldsgrad.toFixed(2)}x) – nær maksimalgrensen på ${MAX_GJELDSGRAD.toFixed(1)}x inntekt.`);
                 initial_score -= 15;
            }


            // Flagg: LTV
            if (boligverdi > 0 && ltv > MAX_LTV) {
                flags.push(`LTV over ${MAX_LTV * 100}% (${(ltv * 100).toFixed(2)}%) – krever ekstra egenkapital eller tilleggssikkerhet.`);
                
                const mål_lan = boligverdi * MAX_LTV;
                const ekstra_egenkapital = onsket_lan - mål_lan;

                suggestions.push(`[LTV] Kunden må stille med ekstra egenkapital på ${formatterTall(ekstra_egenkapital)} kr for å komme under ${MAX_LTV * 100}%.`);
                initial_score -= 25; 
            } else if (boligverdi > 0 && ltv > 0.8) {
                flags.push(`Høy LTV (${(ltv * 100).toFixed(2)}%) – nær grensen på 85%. Noen banker kan kreve strengere vurdering.`);
                initial_score -= 10;
            }

            // Flagg: Rentetest (Forenklet sjekk)
            if (rentetest_okt_belastning > inntekt_mot_belastning) {
                flags.push(`Rentetest feilet (Forenklet): Økt rentebelastning (${formatterTall(rentetest_okt_belastning)} kr/år) overstiger betjeningsevne (20% av inntekt).`);
                suggestions.push(`[Rentetest] Reduser total lånebeløp for å sikre betjeningsevnen ved en renteøkning på 5 prosentpoeng.`);
                initial_score -= 15;
            }

            // Flagg: Øvrige krav
            if (antall_barn_under_18 > 0) {
                flags.push(`Antall barn under 18 år (${antall_barn_under_18}) – Påvirker bankens kostnadsberegning (Sifo-satser).`);
                initial_score -= (antall_barn_under_18 * 3);
            }
            if (har_inkasso_totalt) {
                flags.push(`Aktiv inkassosak / betalingsanmerkning funnet – Umuliggjør søknad hos ordinære banker.`);
                suggestions.push(`[Inkasso] Refinansiering hos en spesialbank (som tillater inkasso) er nødvendig for å løse anmerkningen.`);
                initial_score = 30; // Reduserer score drastisk for ordinære banker
            }
            if (arbeidsforhold_soker === 'Selvstendig næringsdrivende') {
                 flags.push(`Selvstendig næringsdrivende – Krever 3 års dokumentasjon av inntekt. Bankene krever strengere dokumentasjon/buffer.`);
                 initial_score -= 10;
            }
            if (inkasso_bank_historikk && inkasso_bank_historikk.length > 0) {
                flags.push(`Bankhistorikk: Kunden har søkt/fått avslag hos: ${inkasso_bank_historikk}. Kan indikere tidligere utfordringer.`);
                initial_score -= 5;
            }
            if (egenkapital_kilde && egenkapital_kilde.toLowerCase().includes('lån')) {
                flags.push(`Egenkapital delvis finansiert av lån - Krever strengere vurdering av banken.`);
                initial_score -= 5;
            }

            const final_score_base = Math.max(0, Math.min(100, Math.round(initial_score)));

            // --- 4. OPPDATERT Bank Matching og Resultatvisning (ALLE 15 banker) ---

            let bank_matches = [];
            
            // Itererer gjennom ALLE bankene i listen
            BANK_PROFILES.forEach(bank => {
                let match_prosent = final_score_base;
                let is_match = true;

                // Sjekk 1: Inkasso Policy
                if (har_inkasso_totalt && !bank.inkasso) {
                    match_prosent = 0; // Ordinære banker matcher 0% ved inkasso
                    is_match = false;
                } 
                
                // Sjekk 2: Gjeldsgrad Policy
                if (gjeldsgrad > bank.gjeldsgrad_max) {
                    match_prosent -= 30; // Betydelig trekk hvis man er over bankens grense
                    if (gjeldsgrad > bank.gjeldsgrad_max + 1) match_prosent = 0;
                }

                // Sjekk 3: LTV Policy
                if (ltv > bank.ltv_max) {
                    match_prosent -= 20; // Trekk hvis man er over bankens LTV grense
                    if (ltv > bank.ltv_max + 0.1) match_prosent = 0;
                }
                
                // Sjekk 4: Generell Risikofaktor / Bankens Kredittscorekrav (score_min)
                // Juster match basert på bankens type og base score
                if (match_prosent < bank.score_min) {
                    match_prosent = Math.floor(match_prosent * 0.5); // Stor reduksjon hvis score er for lav for bankens minimumskrav
                }

                // Anvend bankens generelle sjansefaktor og sørg for at prosent er innen 0-100
                match_prosent = Math.max(0, Math.min(100, Math.round(match_prosent * bank.sjanse_faktor)));

                bank_matches.push({
                    navn: bank.navn,
                    type: bank.type,
                    prosent: match_prosent
                });
            });

            // Sorter bankene etter høyeste matchprosent
            bank_matches.sort((a, b) => b.prosent - a.prosent);

            let bankMatchHTML = bank_matches.map(bank => {
                const matchProsent = bank.prosent;
                let chanceColor = 'bg-gray-100 border-gray-300 text-gray-800';
                if (matchProsent >= 80) {
                    chanceColor = 'bg-green-50 border-green-600 text-green-700';
                } else if (matchProsent >= 50) {
                    chanceColor = 'bg-yellow-50 border-yellow-600 text-yellow-700';
                } else if (matchProsent > 0) {
                    chanceColor = 'bg-orange-50 border-orange-600 text-orange-700';
                } else {
                    chanceColor = 'bg-red-50 border-red-600 text-red-700 opacity-60';
                }

                return `
                    <div class="bank-card p-3 rounded-lg shadow-sm border-l-4 ${chanceColor} transition-all duration-300">
                        <p class="text-xs font-semibold text-gray-500 mb-1">${bank.type}</p>
                        <h4 class="text-base font-semibold text-[var(--dark-blue)] leading-tight">${bank.navn}</h4>
                        <p class="text-xl font-bold mt-1">${matchProsent}%</p>
                    </div>
                `;
            }).join('');

            // Samle HTML for resultatvisning
            let analysisHTML = `
                <h2 class="text-xl font-bold text-[var(--dark-blue)] pb-3 border-b-2 border-gray-200 mt-0">Analyse Resultat</h2>
                
                <div class="flex flex-col sm:flex-row justify-between gap-6 mb-6 mt-4">
                    <div class="flex-1 p-3 bg-gray-100 rounded-lg shadow-inner">
                        <span class="text-sm font-semibold text-gray-600 block">Total årlig inntekt</span>
                        <span class="huge-number">${formatterTall(total_inntekt)} kr</span>
                    </div>
                    <div class="flex-1 p-3 bg-gray-100 rounded-lg shadow-inner">
                        <span class="text-sm font-semibold text-gray-600 block">Total Lån/Gjeld (Inkl. ønske)</span>
                        <span class="huge-number">${formatterTall(total_lan_pluss_gjeld)} kr</span>
                    </div>
                </div>
                
                <div class="flex flex-col sm:flex-row justify-between gap-6 mb-6 mt-4">
                    <div class="flex-1 p-3 bg-gray-100 rounded-lg shadow-inner">
                        <span class="text-sm font-semibold text-gray-600 block">Gjeldsgrad (DTI)</span>
                        <span class="huge-number">${gjeldsgrad.toFixed(2)}x</span>
                    </div>
                    <div class="flex-1 p-3 bg-gray-100 rounded-lg shadow-inner">
                        <span class="text-sm font-semibold text-gray-600 block">LTV (Låne-verdi)</span>
                        <span class="huge-number">${(ltv * 100).toFixed(2)}%</span>
                    </div>
                </div>


                <!-- Risiko Flagg -->
                <h3 class="flag-title text-lg font-bold text-[var(--dark-blue)] border-b border-gray-300 pb-1 mb-3 mt-4">Risiko Flagg funnet:</h3>
                <div id="risk-flags" class="pl-4">
                    ${flags.length > 0 ? flags.map(f => `<p class="risk-flag">${f}</p>`).join('') : '<p class="text-green-600 font-semibold">Ingen alvorlige risiko flagg funnet. Profilen er sterk.</p>'}
                </div>

                <!-- Løsningsforslag -->
                <h3 class="solution-title text-lg font-bold text-[var(--dark-blue)] border-b border-gray-300 pb-1 mb-3 mt-6">Løsningsforslag</h3>
                <ul id="suggestions-list" class="list-none p-0">
                    ${suggestions.length > 0 ? suggestions.map(s => `
                        <li class="bg-white border-l-4 border-[var(--success-green)] p-3 mb-2 rounded shadow-sm">
                            ${s}
                        </li>
                    `).join('') : '<li class="text-gray-600">Basert på inndata er det ikke nødvendig med umiddelbare endringer, men sjekk detaljert bankmatching.</li>'}
                </ul>

                <!-- Bank Match -->
                <h3 class="bank-title text-lg font-bold text-[var(--dark-blue)] border-b border-gray-300 pb-1 mb-4 mt-6">Bank Matching (Sannsynlighet) - 15 Bankprofiler</h3>
                <div class="bank-match-container grid gap-4">
                    ${bankMatchHTML}
                </div>
            `;

            resultatInnhold.innerHTML = analysisHTML;
            submitBtn.disabled = false;
        };

        /**
         * Viser/skjuler Medsøker-seksjonen basert på checkbox.
         */
        const toggleMedsoker = () => {
            const medsokerDiv = document.getElementById('medsoker_seksjon');
            const checkbox = document.getElementById('medsoker_checkbox');
            if (checkbox.checked) {
                medsokerDiv.classList.remove('hidden');
            } else {
                medsokerDiv.classList.add('hidden');
            }
        };

        /**
         * Setter opp event listeners når DOM er lastet.
         */
        document.addEventListener('DOMContentLoaded', () => {
            document.getElementById('medsoker_checkbox').addEventListener('change', toggleMedsoker);
            document.getElementById('analysis-form').addEventListener('submit', (e) => {
                e.preventDefault();
                kjørAnalyse();
            });
            // Setter opp initiell tilstand
            toggleMedsoker();

            // Legger til input-format/clean-up lyttere (for å fjerne mellomrom og tillate format)
            document.querySelectorAll('input[type="text"][id$="_soker"], input[type="text"][id$="_medsoker"], input[type="text"][id="onsket_lan"], input[type="text"][id="boligverdi"], input[type="text"][id="egenkapital"]').forEach(input => {
                input.addEventListener('input', function() {
                    let rawValue = this.value.replace(/[^0-9]/g, ''); // Fjerner alt unntatt tall
                    if (rawValue) {
                         // Formatterer til Norsk standard med mellomrom
                        this.value = formatterTall(parseInt(rawValue));
                    }
                });
            });
        });
    </script>
</head>
<body class="p-4 sm:p-8 bg-gray-100 min-h-screen flex justify-center items-start">

    <div class="container bg-white p-6 sm:p-8 rounded-xl shadow-2xl mt-8">
        <h1 class="header-title text-2xl font-extrabold pb-3 mb-6">
            PayPlan AI: Saksbehandler V3.0
        </h1>

        <form id="analysis-form">
            
            <!-- Hoveddata: Lån og Bolig -->
            <h2 class="text-xl font-semibold text-[var(--light-blue)] mt-6 mb-4">1. Lån & Eiendom</h2>
            
            <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                <div class="input-group">
                    <label for="onsket_lan">Ønsket Lånebeløp (Boliglån)</label>
                    <input type="text" id="onsket_lan" name="onsket_lan" placeholder="Eks: 4 300 000" required>
                </div>
                <div class="input-group">
                    <label for="boligverdi">Markedsverdi (Eksisterende/Ny bolig)</label>
                    <input type="text" id="boligverdi" name="boligverdi" placeholder="Eks: 5 000 000" required>
                </div>
                <div class="input-group">
                    <label for="egenkapital">Egenkapital (Kontant/buffer)</label>
                    <input type="text" id="egenkapital" name="egenkapital" placeholder="Eks: 750 000">
                </div>
                <div class="input-group">
                    <label for="egenkapital_kilde">Kilde til Egenkapital</label>
                    <input type="text" id="egenkapital_kilde" name="egenkapital_kilde" placeholder="Eks: Sparesaldo, Forskudd arv">
                </div>
            </div>

            <!-- Hovedsøker Seksjon -->
            <h2 class="text-xl font-semibold text-[var(--light-blue)] mt-8 mb-4">2. Hovedsøker Økonomi</h2>

            <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                <div class="input-group">
                    <label for="inntekt_soker">Årlig Bruttoinntekt</label>
                    <input type="text" id="inntekt_soker" name="inntekt_soker" placeholder="Eks: 650 000" required>
                </div>
                <div class="input-group">
                    <label for="arbeidsforhold_soker">Arbeidsforhold</label>
                    <select id="arbeidsforhold_soker" name="arbeidsforhold_soker" class="w-full p-3 border border-gray-300 rounded-md">
                        <option value="Fast ansatt">Fast ansatt</option>
                        <option value="Pensjon">Pensjon (Alders/AFP)</option>
                        <option value="Uføretrygd">Uføretrygd</option>
                        <option value="Selvstendig næringsdrivende">Selvstendig næringsdrivende</option>
                        <option value="Midlertidig ansatt">Midlertidig ansatt</option>
                    </select>
                </div>
            </div>

            <h3 class="text-lg font-medium text-gray-700 mt-6 mb-3 border-b border-dashed pb-2">Gjeld & Forpliktelser (Hovedsøker)</h3>
            <div class="grid grid-cols-2 sm:grid-cols-4 gap-4">
                <div class="input-group">
                    <label for="kredittkort_ramme_soker">Kredittkort Ramme</label>
                    <input type="text" id="kredittkort_ramme_soker" name="kredittkort_ramme_soker" placeholder="Eks: 50 000">
                </div>
                <div class="input-group">
                    <label for="forbrukslan_soker">Forbrukslån (Restgjeld)</label>
                    <input type="text" id="forbrukslan_soker" name="forbrukslan_soker" placeholder="Eks: 120 000">
                </div>
                <div class="input-group">
                    <label for="billan_soker">Billån/Båt (Restgjeld)</label>
                    <input type="text" id="billan_soker" name="billan_soker" placeholder="Eks: 200 000">
                </div>
                <div class="input-group">
                    <label for="studielan_soker">Studielån (Restgjeld)</label>
                    <input type="text" id="studielan_soker" name="studielan_soker" placeholder="Eks: 350 000">
                </div>
            </div>

            <h3 class="text-lg font-medium text-gray-700 mt-6 mb-3 border-b border-dashed pb-2">Øvrig Historikk (Hovedsøker)</h3>
            <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                 <div class="input-group">
                    <label for="antall_barn_under_18">Antall barn under 18 år</label>
                    <input type="number" id="antall_barn_under_18" name="antall_barn_under_18" placeholder="Eks: 2" value="0" min="0">
                </div>
                <div class="input-group">
                    <label for="har_inkasso_soker">Har aktiv inkassosak / anmerkning?</label>
                    <select id="har_inkasso_soker" name="har_inkasso_soker" class="w-full p-3 border border-gray-300 rounded-md">
                        <option value="Nei">Nei</option>
                        <option value="Ja">Ja</option>
                    </select>
                </div>
            </div>
            <div class="input-group mt-4">
                <label for="inkasso_bank_historikk">Hvilke banker er det søkt/fått avslag hos tidligere? (Navn separert med komma)</label>
                <input type="text" id="inkasso_bank_historikk" name="inkasso_bank_historikk" placeholder="Eks: DNB, Sbanken, SpareBank 1">
            </div>

            <!-- Medsøker Seksjon -->
            <h2 class="text-xl font-semibold text-[var(--light-blue)] mt-10 mb-4 flex items-center">
                3. Medsøker Økonomi
                <input type="checkbox" id="medsoker_checkbox" class="ml-4 h-4 w-4 text-[var(--dark-blue)] border-gray-300 rounded focus:ring-[var(--dark-blue)]">
                <label for="medsoker_checkbox" class="text-sm font-normal text-gray-600 ml-2 mb-0 cursor-pointer">Inkluder medsøker</label>
            </h2>

            <div id="medsoker_seksjon" class="hidden border p-4 rounded-lg bg-gray-50 transition-all duration-300">
                <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                    <div class="input-group">
                        <label for="inntekt_medsoker">Årlig Bruttoinntekt (Medsøker)</label>
                        <input type="text" id="inntekt_medsoker" name="inntekt_medsoker" placeholder="Eks: 550 000">
                    </div>
                    <div class="input-group">
                        <label for="har_inkasso_medsoker">Har aktiv inkassosak / anmerkning (Medsøker)?</label>
                        <select id="har_inkasso_medsoker" name="har_inkasso_medsoker" class="w-full p-3 border border-gray-300 rounded-md">
                            <option value="Nei">Nei</option>
                            <option value="Ja">Ja</option>
                        </select>
                    </div>
                </div>

                <h3 class="text-base font-medium text-gray-700 mt-4 mb-3 border-b border-dashed pb-1">Gjeld & Forpliktelser (Medsøker)</h3>
                <div class="grid grid-cols-2 sm:grid-cols-4 gap-4">
                    <div class="input-group">
                        <label for="kredittkort_ramme_medsoker">Kredittkort Ramme</label>
                        <input type="text" id="kredittkort_ramme_medsoker" name="kredittkort_ramme_medsoker" placeholder="Eks: 30 000">
                    </div>
                    <div class="input-group">
                        <label for="forbrukslan_medsoker">Forbrukslån (Restgjeld)</label>
                        <input type="text" id="forbrukslan_medsoker" name="forbrukslan_medsoker" placeholder="Eks: 0">
                    </div>
                    <div class="input-group">
                        <label for="billan_medsoker">Billån/Båt (Restgjeld)</label>
                        <input type="text" id="billan_medsoker" name="billan_medsoker" placeholder="Eks: 0">
                    </div>
                    <div class="input-group">
                        <label for="studielan_medsoker">Studielån (Restgjeld)</label>
                        <input type="text" id="studielan_medsoker" name="studielan_medsoker" placeholder="Eks: 100 000">
                    </div>
                </div>
            </div>

            <button type="submit" id="submit-btn" class="submit-btn bg-[var(--dark-blue)] hover:bg-[var(--light-blue)] text-white py-3 px-6 rounded-lg font-semibold text-lg mt-8 w-full transition-all duration-300 shadow-md">
                Kjør Dyp Analyse
            </button>
        </form>

        <!-- Resultatboks -->
        <div id="results-box" class="results-box mt-10 p-6 rounded-xl border border-[var(--dark-blue)] bg-[var(--result-bg)] shadow-inner hidden">
            <div id="analysis-content">
                <!-- Analyse resultat vises her -->
            </div>
        </div>
        
    </div>

</body>
</html>
